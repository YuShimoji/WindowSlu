# WindowSlu v2.0

作業の邪魔にならない、直感的なウィンドウ管理ユーティリティ。

![アプリケーションのスクリーンショット](placeholder.png)
*(ここにアプリケーションのスクリーンショットやGIFを挿入してください)*

## 概要

`WindowSlu` は、Windows上の任意のウィンドウの透明度を、ホットキーやマウススライダーで手軽に調整できるデスクトップアプリケーションです。v2.0では、グループ化・プリセット・連動ドラッグなどの高度な機能が追加されました。

*   **直感的なウィンドウ操作**: ホットキーやスライダーでリアルタイムに透明度調整
*   **最前面表示 (Always on Top)**: 重要なウィンドウを常に他のウィンドウより手前に表示
*   **クリックスルー**: ウィンドウを操作不能にし、背面のウィンドウを直接クリックできるように
*   **🔥 グループ化機能**: プロセス名ベースの自動グループ化 + 手動グループ作成
*   **🔥 プリセット機能**: サイズ・透明度・位置設定の保存・適用
*   **🔥 カスケード配置**: グループ内ウィンドウの整列配置
*   **🔥 連動ドラッグ**: グループ内ウィンドウの同時移動
*   **🔥 一括操作**: 全ウィンドウへのまとめての透明度適用

集中したい作業がある時、リファレンスを常に表示しておきたい時など、あなたのデスクトップ作業の効率を向上させます。

## 使い方

1.  **実行ファイルの入手**:
    *   リリースページから最新の `WindowSlu.exe` をダウンロードします。
    *   (または、このリポジトリをクローンしてビルドする場合、 `WindowSlu/bin/Release/net9.0-windows/win-x64/publish/` ディレクトリ内に生成されます)
2.  **起動**:
    *   `WindowSlu.exe` をダブルクリックして実行します。
3.  **基本操作**:
    *   Windowsタブで操作したいウィンドウを選択します。
    *   スライダーを動かして透明度を変更します。
    *   ホットキー（`Alt` + `Up`/`Down`など）でアクティブなウィンドウを直接操作します。

### 🔥 新機能の使い方

#### グループ化機能
- **自動グループ化**: 同じプロセス名のウィンドウが自動でグループ化されます
- **手動グループ作成**: Presetsタブから「New」ボタンでカスタムグループを作成できます
- **グループ展開**: グループ名の左にある三角アイコンで折りたたみ/展開

#### プリセット機能
- **Presetsタブ**を開いてプリセットを作成・管理します
- **Name**: プリセット名を入力
- **Size**: ウィンドウサイズを指定 (WxH)
- **Opacity**: 透明度を指定 (0-100%)
- **Always on Top**: 最前面表示のオン/オフ
- **Cascade**: カスケード配置の設定
- **Applyボタン**: 選択したグループ/ウィンドウにプリセットを適用

#### カスケード配置
- グループヘッダーの「▣」ボタンをクリック
- グループ内のウィンドウが重なりながら整列配置されます
- 方向とオフセットはPresetsタブで設定可能

#### 連動ドラッグ
- グループヘッダーの「🔗」ボタンでグループの連動ドラッグを有効化
- グループ内のウィンドウをドラッグすると、他のウィンドウも連動して移動します
- 相対位置が維持されます

#### 一括操作
- **Bulk opacity**: 全ウィンドウの透明度をまとめて設定
- **100%ボタン**: 全ウィンドウの透明度を100%にリセット

## 主な使用技術

*   **言語**: C#
*   **フレームワーク**: .NET 9 (WPF)
*   **UIライブラリ**:
    *   WPF (Windows Presentation Foundation)
    *   [Hardcodet.NotifyIcon.Wpf](https://github.com/hardcodet/wpf-notifyicon) - タスクトレイ機能
*   **アーキテクチャ**: MVVM (Model-View-ViewModel)
*   **Windows API**: Win32 API (SetWindowLong, SetLayeredWindowAttributes, WinEventHook)

## こだわった点・苦労した点

### Windows API との連携

ウィンドウの透明度や表示順序、クリックスルーといったOSレベルの挙動を制御するため、`SetWindowLong` や `SetLayeredWindowAttributes` などのWin32 APIを直接呼び出しています。些細なパラメータの違いで予期せぬエラー（特に `Win32Error: 87`）を引き起こすことがあり、安定した動作を実現するために多くの試行錯誤を重ねました。

### MVVMアーキテクチャへのリファクタリング

プロジェクト初期は、UIのイベント処理とビジネスロジックが密結合しており、機能追加やデバッグが困難な状態でした。
開発の過程で、UI (View)・状態管理 (ViewModel)・ビジネスロジック (Model/Service) の責務を分離するMVVMアーキテクチャへリファクタリングを行いました。これにより、コードの見通しが良くなり、リグレッション（バグの再発）が起きにくい、保守性の高い構造へと改善しました。

### 🔥 高度な機能の実装

#### グループ化・プリセット・カスケード配置
ウィンドウの動的なグループ化と設定の永続化を実現するため、JSONベースの設定保存とTreeViewによる階層表示を実装しました。マルチモニター対応も考慮しています。

#### 連動ドラッグの実装
WinEventHookを使用したシステムレベルのウィンドウ移動検知を実装。デバウンス処理とスレッドセーフな設計により、安定した連動動作を実現しました。

## 今後の展望

*   より高度なプリセット機能（条件付き適用、キーボードショートカット）
*   タスクトレイ機能の強化
*   より洗練されたUI/UXへの改善
*   プラグインシステムによる拡張性向上

---

*This README was generated by an AI assistant.*